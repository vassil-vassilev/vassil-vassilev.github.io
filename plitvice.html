<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Plitvice & Zadar Adventure üá≠üá∑</title>
    
    <!-- Leaflet Map CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary: #0ea5e9;
            --dark: #0f172a;
            --light: #f8fafc;
            --accent: #f59e0b;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Poppins', sans-serif;
            color: var(--dark);
            background-color: white;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* --- LEFT PANEL: CONTENT (50%) --- */
        #content-panel {
            width: 50%;
            height: 100vh;
            overflow-y: auto;
            background: white;
            box-shadow: 5px 0 20px rgba(0,0,0,0.1);
            z-index: 2;
            position: relative;
        }

        .hero-header {
            background: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('https://plus.unsplash.com/premium_photo-1661883801442-3fdb21a619f1?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 5rem 3rem;
            text-align: center;
        }

        .hero-header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 3rem;
            margin: 0;
            text-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }

        .hero-header p {
            font-size: 1.1rem;
            margin-top: 10px;
            font-weight: 300;
        }

        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        .stat-pill {
            background: rgba(255,255,255,0.25);
            backdrop-filter: blur(5px);
            padding: 5px 15px;
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .itinerary-container {
            padding: 3rem;
            max-width: 800px;
            margin: 0 auto;
        }

        /* --- DAY CARD DESIGN --- */
        .day-card {
            background: white;
            border-radius: 16px;
            margin-bottom: 3rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            border: 1px solid #e2e8f0;
            overflow: hidden;
        }

        .day-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            border-color: var(--primary);
        }

        .day-card.active {
            border: 2px solid var(--primary);
            ring: 4px solid rgba(14, 165, 233, 0.1);
        }

        .card-image-banner {
            height: 250px;
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .day-tag {
            position: absolute;
            top: 20px;
            left: 20px;
            background: var(--primary);
            color: white;
            padding: 5px 12px;
            border-radius: 8px;
            font-weight: 700;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .card-body {
            padding: 25px;
        }

        .card-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            color: var(--dark);
            margin: 0 0 10px 0;
        }

        .card-desc {
            color: #475569;
            line-height: 1.7;
            font-size: 0.95rem;
        }

        /* --- THUMBNAIL ROW --- */
        .thumb-row {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #f1f5f9;
            overflow-x: auto;
            padding-bottom: 5px; /* space for scrollbar if needed */
        }

        .thumb-img {
            width: 70px;
            height: 70px;
            object-fit: cover;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
            flex-shrink: 0;
        }

        .thumb-img:hover {
            transform: scale(1.05);
            border-color: var(--primary);
            opacity: 0.9;
        }

        /* --- RIGHT PANEL: MAP (50%) --- */
        #map {
            width: 50%;
            height: 100vh;
        }

        /* --- CUSTOM MAP MARKERS --- */
        .number-icon {
            background-color: var(--dark);
            color: white;
            border: 3px solid white;
            border-radius: 50%;
            text-align: center;
            line-height: 40px;
            font-weight: 700;
            font-size: 18px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: all 0.2s ease;
        }

        .number-icon:hover, .number-icon.active-marker {
            background-color: var(--primary);
            transform: scale(1.2);
        }

        /* --- LIGHTBOX MODAL --- */
        .modal {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.95);
            backdrop-filter: blur(10px);
            justify-content: center;
            align-items: center;
        }

        .modal-content-wrapper {
            position: relative;
            max-width: 90vw;
            max-height: 90vh;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .modal-img {
            max-height: 80vh;
            max-width: 100%;
            border-radius: 4px;
            box-shadow: 0 5px 30px rgba(0,0,0,0.5);
            object-fit: contain;
        }

        .modal-caption-text {
            color: white;
            margin-top: 15px;
            font-family: 'Playfair Display', serif;
            font-size: 1.2rem;
            text-align: center;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }

        .nav-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.1);
            color: white;
            border: 1px solid rgba(255,255,255,0.2);
            font-size: 2rem;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            user-select: none;
        }

        .nav-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-50%) scale(1.1);
        }

        .prev-btn { left: -80px; }
        .next-btn { right: -80px; }

        .close-btn {
            position: absolute;
            top: -50px;
            right: 0;
            color: white;
            font-size: 3rem;
            cursor: pointer;
            line-height: 1;
            transition: transform 0.2s;
        }
        
        .close-btn:hover { transform: scale(1.1); color: var(--accent); }

        /* --- MOBILE RESPONSIVE --- */
        @media (max-width: 768px) {
            body { flex-direction: column-reverse; }
            #content-panel { width: 100%; height: 50vh; }
            #map { width: 100%; height: 50vh; }
            .hero-header { padding: 2rem 1rem; }
            .hero-header h1 { font-size: 2rem; }
            .itinerary-container { padding: 1.5rem; }
            .day-card { margin-bottom: 1.5rem; }
            .card-image-banner { height: 180px; }
            
            /* Mobile Lightbox Nav */
            .prev-btn { left: 10px; top: auto; bottom: 50%; }
            .next-btn { right: 10px; top: auto; bottom: 50%; }
            .close-btn { top: 10px; right: 20px; font-size: 2.5rem; }
        }
    </style>
</head>
<body>

    <!-- Left Panel: Content -->
    <div id="content-panel">
        <div class="hero-header">
            <h1>Plitvice & Zadar Loop</h1>
            <p>5 Days ‚Ä¢ Waterfalls ‚Ä¢ History ‚Ä¢ Sunsets</p>
            <div class="stats-bar">
                <span class="stat-pill">üöó ~16h Driving</span>
                <span class="stat-pill">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Kid Friendly</span>
                <span class="stat-pill">üá≠üá∑ Croatia</span>
            </div>
        </div>

        <div class="itinerary-container" id="itinerary-list">
            <!-- JS will inject cards here -->
        </div>
    </div>

    <!-- Right Panel: Map -->
    <div id="map"></div>

    <!-- Lightbox Modal -->
    <div id="photoModal" class="modal">
        <div class="modal-content-wrapper">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <button class="nav-btn prev-btn" onclick="moveSlide(-1)">&#10094;</button>
            <img id="lightbox-img" class="modal-img" src="">
            <div id="lightbox-caption" class="modal-caption-text"></div>
            <button class="nav-btn next-btn" onclick="moveSlide(1)">&#10095;</button>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <script>
        // --- DATA ---
        const tripData = [
            {
                day: "Day 1",
                title: "Sofia ‚Üí Belgrade ‚Üí Slavonski Brod",
                desc: "We start the adventure by breaking the drive in <b>Belgrade</b>. We'll park at the Kalemegdan Fortress where the kids can explore the <b>Dinosaur Park</b> and the <b>Zoo</b> right inside the medieval walls. After watching the Danube meet the Sava river, we head to <b>Slavonski Brod</b> to sleep near a massive 18th-century star fortress.",
                coords: [44.8236, 20.4503], // Belgrade focused
                zoom: 7,
                bannerImg: "https://bookaweb.s3.eu-central-1.amazonaws.com/media/29689/kalemegdanska-tvrdjava-4.jpg",
                gallery: [
                    { src: "https://bookaweb.s3.eu-central-1.amazonaws.com/media/29689/kalemegdanska-tvrdjava-4.jpg", cap: "Belgrade Fortress (Kalemegdan) overlooking the river." },
                    { src: "https://tzbpz.hr/wp-content/uploads/2022/02/hero-festung.jpg", cap: "Slavonski Brod Fortress (Our overnight stop)." }
                ]
            },
            {
                day: "Day 2",
                title: "Waterfalls: Rastoke & Plitvice",
                desc: "The magic begins. First stop: <b>Rastoke</b>, a fairytale village built <i>on top</i> of waterfalls and watermills. Then, the main event: <b>Plitvice Lakes National Park</b>. We'll take the electric boat across the emerald Lake Kozjak and walk the boardwalks right up to the Great Waterfall. It‚Äôs a UNESCO paradise.",
                coords: [44.9026, 15.6094],
                zoom: 8,
                bannerImg: "https://www.citypal.me/storage/images/1713173771.3898-visit-the-biggest-waterfall-on-plitvice-lakes.jpg",
                gallery: [
                    { src: "https://www.citypal.me/storage/images/1713173771.3898-visit-the-biggest-waterfall-on-plitvice-lakes.jpg", cap: "Plitvice Lakes: The Big Waterfall (Veliki Slap)." },
                    { src: "https://static.saltinourhair.com/wp-content/uploads/2023/08/21155029/croatia-rastoke-9.jpg", cap: "Lush greenery and waterfalls around Rastoke." },
                    { src: "https://images.squarespace-cdn.com/content/v1/665604881782aa23525c3d06/1717530041577-A9IPWAYPN5DZQPQGDML6/Tourist-at-Pltivice-Lakes-National-Park-Croatia.jpg", cap: "Wooden boardwalks over the crystal clear lakes." }
                ]
            },
            {
                day: "Day 3",
                title: "Tesla, Sun & Sea: To Zadar",
                desc: "A quick stop at <b>Smiljan</b> to see Nikola Tesla‚Äôs birth house and sci-fi playground. Then, we hit the coast! In <b>Zadar</b>, we'll swim at Kolovare beach and head to the Old Town for the world-famous sunset. The <b>Sea Organ</b> plays music powered by waves, while the <b>Greeting to the Sun</b> lights up the floor for the kids to dance on.",
                coords: [44.1194, 15.2314],
                zoom: 8,
                bannerImg: "https://www.fiestaybullshit.com/wp-content/uploads/2021/07/Fest.jpg", 
                gallery: [
                    { src: "https://www.fiestaybullshit.com/wp-content/uploads/2021/07/Fest.jpg", cap: "Zadar: The famous sunset by the Sea Organ." },
                    { src: "https://ichef.bbci.co.uk/images/ic/1200x675/p07qnmmw.jpg", cap: "The Sea Organ steps where the ocean plays music." },
                    { src: "https://upload.wikimedia.org/wikipedia/commons/thumb/b/b3/Roman_Forum_in_Zadar%2C_Croatia_%2848607823862%29.jpg/1280px-Roman_Forum_in_Zadar%2C_Croatia_%2848607823862%29.jpg", cap: "Zadar Old Town architecture." },
                    { src: "https://dynamic-media-cdn.tripadvisor.com/media/photo-o/18/01/ce/03/statue-of-nikola-tesla.jpg?w=1200&h=1200&s=1", cap: "Nikola Tesla Memorial: Celebrating science." }
                ]
            },
            {
                day: "Day 4",
                title: "Lazy Morning & History: To Vinkovci",
                desc: "No rushing today. We enjoy a slow morning coffee in Zadar's Roman Forum or a final dip in the sea. In the afternoon, we drive back towards the border, stopping to sleep in <b>Vinkovci</b>, the oldest continuously inhabited town in Europe. It's quiet, safe, and perfect for recharging.",
                coords: [45.2891, 18.8043],
                zoom: 7,
                bannerImg: "https://lp-cms-production.imgix.net/2019-06/a700394ac88d6fb87f5196add93e641c-roman-forum.jpg",
                gallery: [
                    { src: "https://lp-cms-production.imgix.net/2019-06/a700394ac88d6fb87f5196add93e641c-roman-forum.jpg", cap: "Morning at the Roman Forum in Zadar." },
                    { src: "https://thumbs.dreamstime.com/b/center-vinkovci-town-croatia-september-63009814.jpg", cap: "Vinkovci pedestrian center." }
                ]
            },
            {
                day: "Day 5",
                title: "Taste of the Balkans: Return to Sofia",
                desc: "The home stretch! We break the drive in <b>Ni≈°, Serbia</b> for a legendary lunch. We'll grab the famous Balkan grill (Ro≈°tilj) near the fortress before the final easy drive back to Sofia. We'll be home by evening, tired but full of memories.",
                coords: [43.3209, 21.8958],
                zoom: 7,
                bannerImg: "https://www.ekapija.com/thumbs/niska_tvrdjava_060323_tw1024.jpg",
                gallery: [
                    { src: "https://www.ekapija.com/thumbs/niska_tvrdjava_060323_tw1024.jpg", cap: "Ni≈° Fortress Gateway." },
                ]
            }
        ];

        // --- MAP INITIALIZATION ---
        const map = L.map('map').setView([44.5, 19.0], 6);
        L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
            attribution: '¬© OpenStreetMap contributors',
            maxZoom: 19
        }).addTo(map);

        const markers = [];
        
        // Draw Route Line
        const routePoints = [
            [42.6977, 23.3219], // Sofia
            [44.8236, 20.4503], // Belgrade
            [45.1601, 18.0156], // Slavonski Brod
            [44.9026, 15.6094], // Plitvice
            [44.1194, 15.2314], // Zadar
            [45.2891, 18.8043], // Vinkovci
            [43.3209, 21.8958], // Nis
            [42.6977, 23.3219]  // Sofia
        ];
        
        L.polyline(routePoints, {
            color: '#0ea5e9', 
            weight: 5,
            dashArray: '10, 15',
            opacity: 0.8,
            lineCap: 'round'
        }).addTo(map);

        // --- RENDER CONTENT ---
        const container = document.getElementById('itinerary-list');

        tripData.forEach((item, index) => {
            // 1. Create Card
            const card = document.createElement('div');
            card.className = 'day-card';
            card.id = `card-${index}`;
            
            // Build Thumbnail Row
            let thumbHtml = '<div class="thumb-row">';
            item.gallery.forEach((photo, imgIdx) => {
                thumbHtml += `<img src="${photo.src}" class="thumb-img" onclick="openLightbox(${index}, ${imgIdx}, event)" alt="Thumb">`;
            });
            thumbHtml += '</div>';

            card.innerHTML = `
                <div class="card-image-banner" style="background-image: url('${item.bannerImg}');">
                    <div class="day-tag">${item.day}</div>
                </div>
                <div class="card-body">
                    <h3 class="card-title">${item.title}</h3>
                    <div class="card-desc">${item.desc}</div>
                    ${thumbHtml}
                </div>
            `;

            // Interaction
            card.addEventListener('click', () => {
                activateStop(index);
            });

            container.appendChild(card);

            // 2. Create Map Marker
            const numberIcon = L.divIcon({
                className: 'number-icon',
                html: index + 1,
                iconSize: [44, 44],
                iconAnchor: [22, 44],
                popupAnchor: [0, -44]
            });

            const marker = L.marker(item.coords, { icon: numberIcon }).addTo(map);
            marker.on('click', () => {
                // Scroll card into view
                const targetCard = document.getElementById(`card-${index}`);
                targetCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
                activateStop(index);
            });
            
            markers.push({marker, coords: item.coords, zoom: item.zoom});
        });

        function activateStop(index) {
            // UI Updates
            document.querySelectorAll('.day-card').forEach(c => c.classList.remove('active'));
            document.getElementById(`card-${index}`).classList.add('active');
            
            document.querySelectorAll('.number-icon').forEach(i => i.classList.remove('active-marker'));
            // Note: Leaflet divIcons are tricky to target by class after render without reference
            
            // Map Move
            const data = markers[index];
            map.flyTo(data.coords, data.zoom, { duration: 1.5 });
        }

        // --- LIGHTBOX LOGIC ---
        let currentDayIdx = 0;
        let currentImgIdx = 0;
        const modal = document.getElementById('photoModal');
        const lightboxImg = document.getElementById('lightbox-img');
        const lightboxCap = document.getElementById('lightbox-caption');

        window.openLightbox = function(dayIdx, imgIdx, event) {
            event.stopPropagation(); // Don't trigger card click
            currentDayIdx = dayIdx;
            currentImgIdx = imgIdx;
            updateLightbox();
            modal.style.display = 'flex';
        };

        function updateLightbox() {
            const gallery = tripData[currentDayIdx].gallery;
            const data = gallery[currentImgIdx];
            lightboxImg.src = data.src;
            lightboxCap.innerText = `${data.cap} (${currentImgIdx + 1}/${gallery.length})`;
        }

        window.moveSlide = function(step) {
            const gallery = tripData[currentDayIdx].gallery;
            currentImgIdx = (currentImgIdx + step + gallery.length) % gallery.length; // Loop around
            updateLightbox();
        };

        window.closeModal = function() {
            modal.style.display = 'none';
        };

        // Close on background click
        modal.addEventListener('click', (e) => {
            if (e.target === modal) closeModal();
        });
        
        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (modal.style.display === 'flex') {
                if (e.key === 'ArrowLeft') moveSlide(-1);
                if (e.key === 'ArrowRight') moveSlide(1);
                if (e.key === 'Escape') closeModal();
            }
        });

    </script>
</body>
</html>
